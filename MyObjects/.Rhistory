setwd("C:/Users/mas/learning/Network-Analysis-R")
install.packages("statnet")
library(sna)
install.packages("statnet")
library(sna)
degree.ceo <- degree(ceo, gmode = "graph")
degree.ceo
nrow(ceo)
bipartite
degree.club <- degree(club, gmode = "graph")
degree.club
View(ceo)
View(ceo_club)
ceo_club <- matrix(c(
0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0,
0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0,
0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0,
1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1,
0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1,
0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0,
0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1,
0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1,
1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0,
0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1,
0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1,
0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1,
1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1,
0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0),
nrow = 26, byrow = TRUE)
#CEO
rownames(ceo_club) <- paste("n", 1:26, sep = "")
#comitte
colnames(ceo_club) <- paste("m", 1:15, sep = "")
#共通のクラブを有するCEO
ceo <-ceo_club %*% t(ceo_club)
ceo[which(ceo >= 1)] <- 1
diag(ceo) <-0
#共通のCEOを有するクラブ
club <- t(ceo_club) %*% ceo_club
club[which(club >= 1)] <- 1
diag(club) <- 0
#そのまま正方行列に変換
bipartite <- rbind(cbind(matrix(0, 15, 15), t(ceo_club)),
cbind(ceo_club, matrix(0, 26, 26)))
degree(ceo, gmode = "graph")
#共通のクラブを有するCEO
ceo <-ceo_club %*% t(ceo_club)
degree(ceo, gmode = "graph")
degree.bi <- degree(bipartite, gmode = "graph")
library(sna)
degree.bi <- degree(bipartite, gmode = "graph")
degree.bi
degree.club
club
betweenness(ceo, gmode = "graph", ignore.eval = TRUE)
#媒介中心性
bet.ceo <- betweenness(ceo, gmode = "graph", ignore.eval = TRUE)
bet.club <- betweenness(club, gmode = "graph", ignore.eval = TRUE)
bet.club
bet.bi <- betweenness(bipartite, gmode = "graph", ignore.eval = TRUE)
bet.bi
#固有ベクトル中心性
ev.ceo <- abs(eigen(ceo)$vectors[, 1])
ev.ceo
ev.club <- abs(eigen(club)$vectors[, 1])
ev.club
ev.bi <- abs(eigen(bipartite)$vectors[, 1])
ev.bi
ev.club <- abs(eigen(club)$vectors[, 1])
ev.club
ev.ceo
bet.club
ev.club <- abs(eigen(club)$vectors[, 1])
ev.club
degree.club
#共通のCEOを有するクラブ
club <- t(ceo_club) %*% ceo_club
degree.club <- degree(club, gmode = "graph")
degree.club
bet.club <- betweenness(club, gmode = "graph", ignore.eval = TRUE)
bet.club
ev.club <- abs(eigen(club)$vectors[, 1])
ev.club
degree.bi[16:41]
length(degree.bi[16:41])
degree.ceo
cor(degree.ceo, degree.bi[16:41])
degree.ceo
#共通のクラブを有するCEO
ceo <-ceo_club %*% t(ceo_club)
#次数中心性
degree.ceo <- degree(ceo, gmode = "graph")
degree.ceo
#媒介中心性
bet.ceo <- betweenness(ceo, gmode = "graph", ignore.eval = TRUE)
#固有ベクトル中心性
ev.ceo <- abs(eigen(ceo)$vectors[, 1])
cor(degree.ceo, degree.bi[16:41])
cor(degree.club,degree.bi[1:15])
cor(bet.ceo, bet.bi[16:41])
cor(bet.club,bet.bi[1:15])
cor(ev.ceo, ev.bi[16:41])
cor(ev.club,ev.bi[1:15])
A <- matrix(c(
0, 1, 1, 1, 0, 0, 0, 0, 0, 0,
1, 0, 1, 0, 0, 0, 0, 0, 0, 0,
1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 1, 1, 0, 0, 0,
0, 0, 0, 0, 1, 0, 1, 0, 0, 0,
0, 0, 0, 0, 1, 1, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
nrow = 10, byrow = TRUE)
components(A)
# set current directory
setwd("C:/Users/mas/learning/book-tsa-ssm-foundation/MyObjects")
#GLMM
library(lme4)
# 疑似反復と過分散
head(cbpp)
#ロジスティック回帰
#群れのランダム効果を考慮
glmm.bin_1 <- glmer(
cbind(incidence, size - incidence) ~ period + (1 | herd),
family = binomial, data = cbpp)
summary(glmm.bin_1)
cbpp
summary(glmm.bin_1)
#ロジスティック回帰
#群れのランダム効果を考慮
glm.bin <- glm(
cbind(incidence, size - incidence) ~ period,
family = binomial, data = cbpp)
summary(glm.bin)
