# 統計 Tips

* 不偏分散  
推定値から算出した分散は偏りがあるため、固めに見積もる  
⇒ 通常の分散より大きくなるように小さい数字で割る  
* 標準誤差  
推定値の不確実性の尺度、不偏分散をサンプルサイズで割ったもの（中心極限定理）  

  <img src="https://latex.codecogs.com/gif.latex?\sqrt{\frac{s^{2}}{n}}" />  
* p値  
帰無仮説の下で観測される値が、実現したt値を超える確率  
⇒ p値が小さいほどt値は大きい  
⇒ p値が小さいほど有意
⇒ p値が小さいほど帰無仮説は棄却される  
* t検定  
検定量が有意にゼロと異なるかを検定  
  <img src="https://latex.codecogs.com/gif.latex?\frac{\bar{x}}{\sqrt{\frac{s^{2}}{n}}}" />  

* 分散分析（ANOVA）  
条件別に期待値が有意に異なるかを検定  
条件別期待値のばらつきと残差のばらつきの比を検定（Type1）  
無条件期待値（ナイーブ予測）の残差と条件別期待値（条件別予測）の残差の差の検定と同義  
⇒　変数に一つだけモデルを指定した場合（二つ指定すると両者の残差の差の検定となる  
Type2は各変数を除いた時の残差の変分を検定している  
交差項を含む回帰モデルを検定する場合はType3を用いる    

* パラメトリックブートストラップ検定  
任意の条件に基づくデータをシミュレーションで生成して分布を作成し、実際のデータが当該分布において、どう評価されるかを確認する  

* 尤度  
設定したパラメータの時に実際に得られたデータ系列が発生する確率  
実際に得られたデータ系列が想定したパラメータの分布から発生する確率  
尤度が最も高くなるようにパラメータを決定するのが最尤法  
分布は何でも  
ログを取ったものが対数尤度  

* AIC  
　`-2 × （対数尤度 - パラメータ数）`: 予測値の対数尤度の期待値（バイアス調整済み）  
　⇒ 予測値の当てはまりの期待値を表す  

* 一般化線形モデル  
線形予測子:  
　モデルの右辺、説明変数の線形結合部分  
リンク関数:  
　モデルの左辺、被説明変数を変換する関数（ログ、逆関数、ロジット等）  
　変換された説明変数は正規分布に従う  
誤差構造:  
　（リンク関数で変換前の）被説明変数が従うべき確率分布（二項分布、ポアソン分布、ガンマ分布等）  
　ポアソン分布 ⇒ 自然数の分布に適用  
　　　　　　　　　オフセット項を用いることで正の実数も扱える  
　二項分布 ⇒ True or Falseの確率値の予測  
　ガンマ分布 ⇒ 正の実数値で誤差分散が説明変数に比例して増加する  
　　　　　　　　 共通のshapeと説明変数に応じて線形に変化するscaleを推定する  
　疑似二項分布 ⇒ 二項分布を適用するとデータに過分散が生じる場合に用いる  
　　　　　　　　　　疑似尤度を用いるため、係数の推定精度は高まるが、正確な尤度は計算できない  
　　　　　　　　　　モデルの検定も尤度比検定ではなくANOVA同様F検定となる  
          
* 対数線形モデル  
　分割表における各カテゴリカル変数、及びその交差項の説明力を表現するモデル  


* 一般化線形モデルの検定  
deviance（尤離度、逸脱度）:  
　完璧な予測の対数尤度と推定したモデルの対数尤度の差を2倍したもの  
　モデルの説明力が高いほど、小さくなる（正規線形モデルの二乗誤差に相当）  
　全データで一つの値  
deviance残差:  
　各データの対数確率の差（完璧なモデルと予測モデル）の2倍を平方根（正負は予測値の大小で決める）  
　各モデル（完璧なモデル、予測モデル）に基づく発生確率の対数値を取り、その差の2倍を平方根したもの（正負は予測値の大小で決める）  
　符号は予測値が実測値より小さい場合に正、大きい場合に負とする  
　二乗合計はdevianceに一致する ⇒ 正規線形モデルの残差同様に扱える  
ward検定:  
　正規線形モデルに対する回帰係数のt検定に相当  
　正規分布する（故にz統計量と呼ぶ）  
尤度比検定:  
　正規線形モデルのANOVAに相当  
　ナイーブ予測のdevianceと予測モデルのdevianceの差の検定  
　devianceの差（尤度比の対数値×２）  
　カイ二乗分布に従う（但し、サンプルサイズが必要）  
* 特殊なモデル  
 * ゼロ切断モデル  
  ゼロでない条件下での発生回数予測モデル（カウントモデル）  
  * ゼロインフレモデル  
  発生回数予測モデルと、誤ってゼロと観測される可能性を予測するモデルの組み合わせ  
  一つ目のモデルで予測した回数の内幾つかが、二つ目のモデルでゼロに置き換えられる  
  * ハードルモデル  
  ゼロを予測するモデルとゼロ切断モデルの組み合わせ  
